<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        img {
            width: 120px;
        }

        html, body {
            padding: 0;
            margin: 0;
        }

        .box {
            width: 500px;
            height: 2000px;
            margin: 0 auto;
            position: relative;
        }

        .box2 {
            width: 100px;
            height: 100px;
            background-color: coral;
            position: fixed;
            transform: translateX(200px);
        }

    </style>
</head>
<body>
<div class="box2"></div>
<div class="box">
    Lorem ipsum dolor sit amet, consectetur adipisicing elit. Accusantium architecto exercitationem totam. Autem dolore
    earum et hic ipsam laboriosam nobis nostrum numquam odit possimus quos sequi, similique, veritatis? Accusamus
    accusantium ad alias atque distinctio ea eligendi eveniet in iure magnam maiores maxime minus modi provident ratione
    recusandae reprehenderit rerum similique, sit voluptatem. Aliquam aliquid et eum iure magni nostrum perferendis
    porro quam quasi, quibusdam. Aliquam asperiores aut delectus eaque esse illum laudantium, minima optio quam quidem
    quod repellendus sit unde? Ab accusamus ad adipisci aliquam animi aspernatur consequuntur corporis culpa deserunt
    eaque earum error et eveniet excepturi explicabo hic illo illum, ipsam iste labore libero nam nisi nostrum odit
    omnis optio perferendis provident quibusdam quisquam quo reiciendis repudiandae sint sit tenetur vel velit voluptas?
    Accusantium amet aperiam at cumque cupiditate delectus dignissimos distinctio eligendi et excepturi expedita,
    explicabo harum illum iure iusto nam nihil nostrum obcaecati optio provident quisquam quos sunt ut vitae voluptatem!
    Ab assumenda atque beatae delectus deleniti est eveniet iste laborum magni maiores nam natus odio quisquam soluta
    sunt, temporibus tenetur vel? Error est maiores minima optio quas reprehenderit velit vitae! Doloribus ducimus id
    laborum nobis, officiis saepe unde? Accusamus deleniti et incidunt minima odio perspiciatis porro possimus suscipit
    voluptatibus. Iste itaque, modi. Ab aspernatur at atque consectetur deleniti dolore error exercitationem fuga fugiat
    fugit itaque iure laboriosam magni mollitia nesciunt nihil omnis pariatur, quasi quidem quod recusandae rem sequi
    sint. Consectetur cumque debitis deleniti ducimus excepturi molestiae quibusdam reiciendis sint totam voluptatibus.
    Adipisci aliquam, at culpa debitis delectus deserunt dignissimos eos eum facere ipsam labore laborum magnam maiores
    minus nostrum obcaecati, odio omnis possimus praesentium quaerat qui rem rerum, sapiente tempore tenetur. Architecto
    beatae deserunt dolor itaque, minus nemo nesciunt perspiciatis porro quae, quidem, repellat repudiandae rerum
    similique tempore unde vel velit. Earum exercitationem laudantium magnam nesciunt quasi quisquam ut. Doloremque
    illum laborum maxime quam ut? Accusantium alias aperiam consectetur modi molestiae optio rerum. Ad aliquid autem
    debitis eveniet facilis hic perferendis quae quia, quibusdam tenetur. Ab alias architecto consectetur, consequatur
    cumque debitis deleniti deserunt est eveniet excepturi harum hic libero necessitatibus non odio quis quisquam rerum
    ut veniam veritatis! Alias animi architecto aspernatur assumenda aut blanditiis consequuntur dicta dolor eveniet
    harum id illum magnam magni maiores maxime modi molestiae nihil obcaecati pariatur porro, provident quisquam ratione
    sint tempora tenetur vel voluptas! Animi consequuntur dolor dolorem eveniet obcaecati provident reprehenderit
    voluptate voluptates! Adipisci asperiores aut beatae commodi consequatur consequuntur culpa cum cupiditate deleniti
    dolor facilis ipsam iste, laboriosam nemo nesciunt nulla obcaecati omnis pariatur praesentium provident quas quasi
    quidem quis rem tempora unde vero voluptatibus? Cupiditate dolorem dolorum est iusto odit quis tempora? Ab alias
    amet assumenda consectetur doloribus ex impedit perspiciatis quasi sed sequi! At autem delectus eveniet itaque vero.
    Doloremque ea enim eveniet harum quae sit vel! Assumenda blanditiis consectetur consequuntur cupiditate dolore
    doloremque esse excepturi fugiat fugit incidunt iure laudantium mollitia neque nesciunt nisi, odio officia quasi
    repellat rerum suscipit vitae voluptate voluptatum. Aliquam distinctio excepturi fugit harum nulla pariatur sint.
    Alias delectus ducimus eaque illo, laudantium magnam non recusandae vero? Autem eius exercitationem quas quidem
    repellat ullam. Beatae delectus dignissimos dolores, doloribus eius, ex explicabo illo iure nemo neque nesciunt
    pariatur reiciendis rerum similique voluptates? Ab adipisci asperiores aspernatur, blanditiis commodi dolore
    doloremque eligendi eveniet facilis illo magnam maiores minus nostrum nulla porro quaerat quam repellendus
    reprehenderit saepe sequi ullam unde veniam vero! A cumque error impedit ipsam laborum, possimus quaerat sint?
    Consequatur, repellat, soluta? Accusamus, ad adipisci blanditiis corporis eaque esse eveniet ex id ipsa maiores
    minima mollitia qui quia, repellat sapiente temporibus voluptatibus? Accusantium commodi doloribus eum nesciunt
    nihil quibusdam. Ab aliquid at cupiditate dolore ea esse harum illo ipsum obcaecati quae quo, sint velit voluptas.
    Dolore ea minima optio quae quos voluptatibus! Aspernatur blanditiis culpa, ex facilis iste minus nobis numquam
    quos? A magni perferendis ullam. Accusamus amet aperiam consequatur cupiditate dolorum earum exercitationem magni
    modi nulla porro quam quasi qui rerum sapiente sed, sint, totam veritatis, voluptatibus. Aspernatur cum dignissimos
    dolor dolore, ea enim, esse et excepturi harum, in ipsa ipsam iste laborum magnam nihil odit pariatur praesentium
    quam reprehenderit soluta unde veniam voluptas. Accusamus cum dolorum eos error et, fuga iure magni molestias nam
    necessitatibus nihil nulla, officiis quam reiciendis sequi soluta, totam ullam! Alias commodi dolore enim et fuga
    ipsum minus molestias nulla sequi, voluptatibus. Ad aliquam assumenda dolores enim iste molestiae quaerat quam quasi
    quia quis. Ab adipisci asperiores aspernatur consequatur dolores doloribus dolorum eaque, eius error eveniet harum
    laboriosam maxime molestias mollitia non odit qui quo quos rem repellat suscipit temporibus tenetur? Architecto,
    atque dolor esse eveniet, incidunt labore nihil obcaecati odio optio, possimus quae quaerat quam suscipit veniam
    voluptatibus? Debitis dolore facere ipsam iusto neque nobis odit, officiis, recusandae reiciendis sequi sunt
    suscipit tempora, vitae. Accusantium, asperiores at atque delectus deleniti earum eos error est necessitatibus,
    nostrum quasi, qui reprehenderit repudiandae? Dicta, est hic incidunt maxime minima neque rem soluta voluptatum.
    Accusamus, at autem beatae commodi consequatur delectus dignissimos dolor facilis fugiat illum inventore minima
    necessitatibus provident quisquam rem soluta voluptas. Aliquid aspernatur ducimus id tenetur. Accusantium ad,
    aliquam asperiores blanditiis consequatur cum debitis dolor doloremque enim error exercitationem fugit illo
    laboriosam obcaecati possimus quaerat quos repellat tenetur ut voluptate. Distinctio, dolore esse obcaecati porro
    quo sequi vitae. Placeat possimus, voluptate! Accusamus accusantium ad corporis debitis delectus doloremque dolores
    error hic, impedit ipsum itaque minima possimus quas quis reprehenderit vitae voluptatem! Consequuntur cum delectus
    ex similique? Aliquid amet autem cumque earum, impedit inventore iste laborum maxime nemo nisi officia quod tempore
    ullam. A aut doloremque ducimus est iusto labore laborum, magni maiores quae quam quia sint sit voluptatibus. Amet
    assumenda, delectus dicta eos fugit hic itaque maxime nihil pariatur perferendis quia reprehenderit sapiente sunt
    vel veritatis, voluptas voluptates? Accusamus alias animi architecto, aspernatur blanditiis commodi ea eveniet
    facilis itaque minus molestiae neque officia, perspiciatis recusandae, sapiente temporibus vero voluptatibus.
    Aspernatur cum doloribus incidunt ipsum maiores molestias nostrum quo similique unde? Alias commodi, consequatur
    consequuntur dicta dignissimos eius impedit incidunt nostrum, officia ullam voluptates.

</div>

<script>
    function animate(obj,json,fn) {  // 给谁    json
        clearInterval(obj.timer);
        obj.timer = setInterval(function() {
            var flag = true;  // 用来判断是否停止定时器   一定写到遍历的外面
            for(var attr in json){   // attr  属性     json[attr]  值
                //开始遍历 json
                // 计算步长    用 target 位置 减去当前的位置  除以 10
                // console.log(attr);
                var current = 0;
                if(attr == "opacity")
                {
                    current = Math.round(parseInt(getStyle(obj,attr)*100)) || 0;
                    console.log(current);
                }
                else
                {
                    current = parseInt(getStyle(obj,attr)); // 数值
                }
                // console.log(current);
                // 目标位置就是  属性值
                var step = ( json[attr] - current) / 5;  // 步长  用目标位置 - 现在的位置 / 10
                step = step > 0 ? Math.ceil(step) : Math.floor(step);
                //判断透明度
                if(attr == "opacity")  // 判断用户有没有输入 opacity
                {
                    if("opacity" in obj.style)  // 判断 我们浏览器是否支持opacity
                    {
                        // obj.style.opacity
                        obj.style.opacity = (current + step) /100;
                    }
                    else
                    {  // obj.style.filter = alpha(opacity = 30)
                        obj.style.filter = "alpha(opacity = "+(current + step)* 10+")";

                    }
                }
                else if(attr == "zIndex")
                {
                    obj.style.zIndex = json[attr];
                }
                else
                {
                    obj.style[attr] = current  + step + "px" ;
                }

                if(current != json[attr])  // 只要其中一个不满足条件 就不应该停止定时器  这句一定遍历里面
                {
                    flag =  false;
                }
            }
            if(flag)  // 用于判断定时器的条件
            {
                clearInterval(obj.timer);
                //alert("ok了");
                if(fn)   // 很简单   当定时器停止了。 动画就结束了  如果有回调，就应该执行回调
                {
                    fn(); // 函数名 +  （）  调用函数  执行函数
                }
            }
        },30)
    }
    function getStyle(obj,attr) {  //  谁的      那个属性
        if(obj.currentStyle)  // ie 等
        {
            return obj.currentStyle[attr];  // 返回传递过来的某个属性
        }
        else
        {
            return window.getComputedStyle(obj,null)[attr];  // w3c 浏览器
        }
    }
</script>
<script>
    window.onload = function () {
        var box = document.querySelector('.box2');
        animate(box,{
            left:300
        })
    }
</script>
</body>
</html>